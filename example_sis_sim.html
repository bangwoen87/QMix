

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>A Simple Example &mdash; QMix 0.1.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="QMix 0.1.1 documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> QMix
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="project.html">1. The QMix Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">2. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="important_modules.html">3. Key Modules</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">QMix</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>A Simple Example</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/example_sis_sim.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="a-simple-example">
<h1>A Simple Example<a class="headerlink" href="#a-simple-example" title="Permalink to this headline">¶</a></h1>
<p>This example will determine the tunneling currents in an SIS junction
based on the voltage applied across the junction (i.e., the junction
drive level, <span class="math">\(\alpha\)</span>). This example assumes that the voltage
across the junction is constant and already known (harmonic balance is
not needed).</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">qmix</span>
<span class="kn">from</span> <span class="nn">qmix.constants</span> <span class="k">import</span> <span class="n">MILLI</span><span class="p">,</span> <span class="n">GIGA</span><span class="p">,</span> <span class="n">ECHARGE</span><span class="p">,</span> <span class="n">PLANCK</span>
</pre></div>
</div>
<div class="section" id="define-junction-properties">
<h2>Define junction properties<a class="headerlink" href="#define-junction-properties" title="Permalink to this headline">¶</a></h2>
<p>Basic electrical properties of the SIS junction.</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="n">v_gap</span> <span class="o">=</span> <span class="mf">2.8</span> <span class="o">*</span> <span class="n">MILLI</span>               <span class="c1"># gap voltage in [V]</span>
<span class="n">r_n</span> <span class="o">=</span> <span class="mi">14</span>                          <span class="c1"># normal resistance in [ohms]</span>
<span class="n">f_gap</span> <span class="o">=</span> <span class="n">ECHARGE</span> <span class="o">*</span> <span class="n">v_gap</span> <span class="o">/</span> <span class="n">PLANCK</span>  <span class="c1"># gap frequency in [Hz]</span>
</pre></div>
</div>
</div>
<div class="section" id="define-circuit-parameters">
<h2>Define circuit parameters<a class="headerlink" href="#define-circuit-parameters" title="Permalink to this headline">¶</a></h2>
<p>Basic electrical properties of the embedding circuit</p>
<p><strong>Note:</strong> In all of the reference papers, the first frequency is listed
as f=1 and the first harmonic is listed as p=1. Numpy arrays are
0-based, but for the circuit parameters, I have designed this package to
have the first entry start at index=1.</p>
<p><strong>Note:</strong> This example doesn&#8217;t include the embedding impedance since it
assumes you already know the junction voltage.</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="c1"># number of tones/frequencies (f)</span>
<span class="n">num_f</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># number of harmonics (p)</span>
<span class="n">num_p</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># signal frequency (unnormalized)</span>
<span class="n">f_sig</span> <span class="o">=</span> <span class="mi">230</span> <span class="o">*</span> <span class="n">GIGA</span>

<span class="c1"># create new instance of embedding circuit</span>
<span class="n">cct</span> <span class="o">=</span> <span class="n">qmix</span><span class="o">.</span><span class="n">circuit</span><span class="o">.</span><span class="n">EmbeddingCircuit</span><span class="p">(</span><span class="n">num_f</span><span class="p">,</span> <span class="n">num_p</span><span class="p">)</span>

<span class="c1"># photon voltage:  vph[f] in R^(num_f+1)</span>
<span class="n">cct</span><span class="o">.</span><span class="n">vph</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_sig</span> <span class="o">/</span> <span class="n">f_gap</span>

<span class="c1"># voltage across junction:  vj[f, p, vb] in C^(num_f+1, num_p+1, npts)</span>
<span class="n">vj</span> <span class="o">=</span> <span class="n">cct</span><span class="o">.</span><span class="n">initialize_vj</span><span class="p">()</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.2</span>
<span class="n">vj</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">cct</span><span class="o">.</span><span class="n">vph</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="section" id="define-simulation-parameters">
<h2>Define simulation parameters<a class="headerlink" href="#define-simulation-parameters" title="Permalink to this headline">¶</a></h2>
<p>The number of Bessel functions to include: num_b - Ideally we would
include an infinite number of Bessel functions, but practically, we need
to truncate this number somewhere. This number depends on the number of
tones and the signal strengths. Typically num_b=8 is okay for a single
tone with alpha &lt; 2. num_b=15 is okay for multiple tones with alpha &lt;
2. - This is essentially how many absorbed photons will be considered.
See Kennedy&#8217;s or Kittara&#8217;s thesis for more info. - num_b can either be
single integer (in which case the same number of bessel functions will
be used for each tone), or it can be a tuple with one entry for each
tone.</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="c1"># number of Bessel functions</span>
<span class="n">num_b</span> <span class="o">=</span> <span class="mi">15</span>
</pre></div>
</div>
</div>
<div class="section" id="load-desired-response-function">
<h2>Load desired response function<a class="headerlink" href="#load-desired-response-function" title="Permalink to this headline">¶</a></h2>
<p>Among other properties, this class contains: - the characteristic I-V
curve, - its Kramers-Kronig transform, and - the cubic spline fits to
allow for quick interpolation.</p>
<p>In this example, the response function is based of the polynomial I-V
curve model from Kennedy&#8217;s thesis.</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="n">p_order</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">qmix</span><span class="o">.</span><span class="n">respfn</span><span class="o">.</span><span class="n">RespFnPolynomial</span><span class="p">(</span><span class="n">p_order</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="calculate-desired-tunnelling-currents">
<h2>Calculate desired tunnelling currents<a class="headerlink" href="#calculate-desired-tunnelling-currents" title="Permalink to this headline">¶</a></h2>
<p><strong>Note:</strong> The tunneling current function will only solve for the
tunneling currents at the desired frequencies. You determine which
currents you would like to solve for by listing their photon voltages in
vph_list.</p>
<p>E.g., if you want to solve for the DC current and the AC current at
frequency=f_sig, your vph_list would be:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">vph_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">f_sig</span><span class="o">/</span><span class="n">f_gap</span><span class="p">]</span>
</pre></div>
</div>
<p>Then, the output current will correspond to the order of vph_list:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">current[0,:]</span></code> corresponds to <code class="docutils literal"><span class="pre">vph_list[0]</span></code> (i.e., f=0), and</li>
<li><code class="docutils literal"><span class="pre">current[1,:]</span></code> corresponds to <code class="docutils literal"><span class="pre">vph_list[1]</span></code> (i.e., f=f_sig).</li>
</ul>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="n">vph_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">cct</span><span class="o">.</span><span class="n">vph</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">current</span> <span class="o">=</span> <span class="n">qmix</span><span class="o">.</span><span class="n">mixer_current</span><span class="o">.</span><span class="n">mixer_current</span><span class="p">(</span><span class="n">vph_list</span><span class="p">,</span> <span class="n">vj</span><span class="p">,</span> <span class="n">cct</span><span class="p">,</span> <span class="n">resp</span><span class="p">,</span> <span class="n">num_b</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Calculating</span> <span class="n">tunneling</span> <span class="n">current</span><span class="o">...</span>
 <span class="o">-</span> <span class="mi">1</span> <span class="n">tone</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">Done</span><span class="o">.</span>
<span class="n">Time</span><span class="p">:</span> <span class="mf">0.01</span> <span class="n">s</span>
</pre></div>
</div>
</div>
<div class="section" id="post-processing">
<h2>Post-processing<a class="headerlink" href="#post-processing" title="Permalink to this headline">¶</a></h2>
<p>Plot DC and AC currents</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># plot pumped i-v curve</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">voltage</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">current_dc0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;DC I-V&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cct</span><span class="o">.</span><span class="n">vb</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pumped I-V&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Bias Voltage&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;DC Current&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;DC Currents&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<img alt="_images/output_14_1.png" src="_images/output_14_1.png" />
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="c1"># plot ac tunnelling current</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cct</span><span class="o">.</span><span class="n">vb</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">current</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Abs&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cct</span><span class="o">.</span><span class="n">vb</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">current</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cct</span><span class="o">.</span><span class="n">vb</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">current</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Imaginary&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Bias Voltage&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;AC Current&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;AC Current @ $f = f_</span><span class="si">{sig}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<img alt="_images/output_15_1.png" src="_images/output_15_1.png" />
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, John Garrett.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>