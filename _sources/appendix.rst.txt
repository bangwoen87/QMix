Appendix
========

I-V Curve Models
----------------

Chalmers I-V Curve Model
^^^^^^^^^^^^^^^^^^^^^^^^

An I-V curve model is used in:

   H. Rashid, et al., "Harmonic and reactive behavior of the quasiparticle tunnel current in SIS junctions," AIP Advances, vol. 6, 2016.

that includes the ability to add subgap resistance, and control the smearing/non-linearity width at the transition voltage (:math:`V_g`).

.. math::

   I_{dc}(V)  &= \left[\dfrac{V}{R_L} \left(  \dfrac{1}{1 + e^{-a(V+V_g)}}   \right)   +    \dfrac{V}{R_N} \left(  \dfrac{1}{1 + e^{a(V+V_g)}}   \right)    \right]\\
              &+ \left[\dfrac{V}{R_L} \left(  \dfrac{1}{1 + e^{a(V-V_g)}}   \right)   +    \dfrac{V}{R_N} \left(  \dfrac{1}{1 + e^{-a(V-V_g)}}   \right)    \right]

where

   * :math:`I_{dc}` is the dc I-V curve
   * :math:`V` is the bias voltage
   * :math:`V_g` is the gap voltage
   * :math:`a` describes the non-linearity at :math:`V_g`
   * :math:`R_L` is the subgap resistance
   * :math:`R_N` is the normal resistance

The normalized I-V curve for this model are shown below.

.. image:: _images/ivmodel_chalmers.jpg
    :width: 500px
    :align: center
    :alt: alternate text




Expanded I-V Curve Model
^^^^^^^^^^^^^^^^^^^^^^^^

I began with the model described in sec:`Chalmers I-V Curve Model`_, but I then added leakage current, the notch often seen above the gap, and the ability to add a current offset above the gap.

This is the model that I fit to experimental I-V data.

.. math::

   I_{dc}(V)  &= 2 I_L \left( \dfrac{1}{1+e^{-a_0 V}}\right) - I_L \\
        &+ I_L \left( \dfrac{1}{1 + e^{a(V+V_g)}} -  \dfrac{1}{1 + e^{-a(V-V_g)}}\right)  \\
        &+ \dfrac{V}{2R_L} \left( \dfrac{1}{1 + e^{-a(V+V_g)}} - \dfrac{1}{1 + e^{a(V+V_g)}}\right) \\
        &+ \dfrac{V}{2R_L} \left(  \dfrac{1}{1 + e^{a(V-V_g)}} -\dfrac{1}{1 + e^{-a(V-V_g)}} \right) \\
        &+ \dfrac{V}{R_N} \left( \dfrac{1}{1 + e^{a(V+V_g)}} + \dfrac{1}{1 + e^{-a(V-V_g)}}\right) \\
        &+ I_n \left( \dfrac{1}{1 + e^{a_n(V-V_n)}} + \dfrac{1}{1 + e^{a_n(V+V_n)}} \right) - I_n \\
        &+ I_o \left( \dfrac{1}{1 + e^{a(V-V_g)}} + \dfrac{1}{1 + e^{a(V+V_g)}} \right) - I_o 

where

   * :math:`I_{dc}` is the dc I-V curve
   * :math:`I_L` is the leakage current
   * :math:`a_0` describes the non-linearity width seen at the origin
   * :math:`V` is the bias voltage
   * :math:`V_g` is the gap voltage
   * :math:`a` describes the non-linearity width seen at :math:`V_g`
   * :math:`R_L` is the subgap resistance
   * :math:`R_N` is the normal resistance
   * :math:`I_n` is the notch current
   * :math:`V_n` is the notch voltage
   * :math:`a_n` describes the non-linearity width of the notch
   * :math:`I_o` is the offset current (above the gap)

Note:

   * Line 1-2 describe the leakage current
   * Line 3-4 describe the subgap resistance
   * Line 5 describes the transition at :math:`V_g` and the normal resistance
   * Line 6 describes the notch
   * Line 7 describes the current offset above :math:`V_g`

This model contains 10 independent parameters (excluding the bias voltage). As long as a reasonable initial guess is provided, these parameters can be fit to experimental data using a standard non-linear least squares fit (e.g., `curve_fit in the SciPy package for Python <http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html>`_).

The model is shown below. Note the differences between this model and the one shown under sec:`Chalmers I-V Curve Model`_. 

   * there is a sharp initial rise just above :math:`V=0` to account for leakage current
   * there is a notch above the transition voltage
   * the current is reduced above the gap.

.. image:: _images/ivmodel_extended.jpg
    :width: 500px
    :align: center
    :alt: alternate text

The addition of leakage current really helps fit the model to experimental data below the gap.

.. image:: _images/ivmodel_extended_exp1.png
    :width: 500px
    :align: center
    :alt: alternate text

And the addition of the notch and current offset likewise help fit the model to experimental data above the gap.

.. image:: _images/ivmodel_extended_exp2.png
    :width: 500px
    :align: center
    :alt: alternate text

The mean residual error for the example shown above is 0.68 uA. The worst fitting area is just below the gap voltage. Additional parameters could be added to fit this area as well, but I feel that 10 is enough for now.

.. raw:: latex

    \newpage
    